---
title: "PM566 Lab 3"
author: "Victor"
format:
  html:
    embed-resources: true
---

# 1

```{r}
met <- read.csv("~/Downloads/met_all.gz")
```

# 2

```{r}
dim(met)
head(met)
tail(met)
```

2377343 rows 30 cols

# 3

```{r}
str(met)
```

# 4

```{r}
table(met$year)
table(met$day)
table(met$hour)
summary(met$temp)
summary(met$elev)
summary(met$wind.sp)
```

```{r}
met$elev[met$elev==9999.0] <- NA

summary(met$elev)
```

4113 meters

```{r}
met <- met[met$temp>-40,]
met2 <- met[order(met$temp),]
head(met2)
```

# 5

```{r}
met$elev[which.min(met$temp)]
range(met$elev, na.rm = TRUE)
```

```{r}
met <- met[met$temp>-15,]
met2 <- met[order(met$temp),]
head(met2)
```

# 6

```{r}
elev <- met[met$elev==max(met$elev, na.rm=TRUE), ]
summary(elev)
```

```{r}
cor(elev$temp, elev$wind.sp, use="complete")
cor(elev$temp, elev$hour, use="complete")
cor(elev$wind.sp, elev$day, use="complete")
cor(elev$wind.sp, elev$hour, use="complete")
cor(elev$temp, elev$day, use="complete")
```

# 7

```{r}
hist(met$elev, breaks=100)
hist(met$temp)
hist(met$wind.sp)
```

```{r}
library(leaflet)
leaflet(elev) %>%
  addProviderTiles('OpenStreetMap') %>% 
  addCircles(lat=~lat,lng=~lon, opacity=1, fillOpacity=1, radius=100)
```

```{r}
library(lubridate)
elev$date <- with(elev, ymd_h(paste(year, month, day, hour, sep= ' ')))
summary(elev$date)
elev <- elev[order(elev$date), ] 
head(elev)

```

```{r}
# par(mfrow=c(2,1))
plot(elev$date, elev$temp, type='l')
plot(elev$date, elev$wind.sp, type='l')
```

Temperature: Shows regular daily temperature cycles with peaks around 12-14°C and lows around 2-4°C, indicating ...

Wind speed: Displays more irregular patterns compared to temperature, with wind speeds ranging from near 0 to \~20 m/s. There appears to be increased wind activity in mid-to-late August, with more variable and sustained higher wind speeds during certain periods...

# 8

```{r}
library(corrplot)
cor_matrix <- cor(met[, c("temp", "wind.sp", "elev", "atm.press", "rh", 
                          "dew.point")], use="complete.obs")
corrplot(cor_matrix, method="color", type="upper", 
         title="Correlation Matrix of Weather Variables", 
         mar=c(0,0,1,0))
```
